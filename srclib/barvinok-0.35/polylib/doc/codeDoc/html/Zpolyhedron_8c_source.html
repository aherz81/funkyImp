<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>polylib: Zpolyhedron.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">polylib&#160;<span id="projectnumber">5.22.5</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('Zpolyhedron_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Zpolyhedron.c</div>  </div>
</div>
<div class="contents">
<a href="Zpolyhedron_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">    This file is part of PolyLib.</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">    PolyLib is free software: you can redistribute it and/or modify</span>
<a name="l00005"></a>00005 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
<a name="l00006"></a>00006 <span class="comment">    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00007"></a>00007 <span class="comment">    (at your option) any later version.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">    PolyLib is distributed in the hope that it will be useful,</span>
<a name="l00010"></a>00010 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00011"></a>00011 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00012"></a>00012 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00015"></a>00015 <span class="comment">    along with PolyLib.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00016"></a>00016 <span class="comment">*/</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;polylib/polylib.h&gt;</span> 
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> * <a class="code" href="Zpolyhedron_8c.html#a342b4aae95e1b5fcd31bde39de7e5676">ZPolyhedronIntersection</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *);
<a name="l00022"></a>00022 <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">ZPolyhedron_Copy</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A);
<a name="l00023"></a>00023 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol);
<a name="l00024"></a>00024 <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> * <a class="code" href="Zpolyhedron_8c.html#a07af455469e4301a457a5e0265a6d545">ZPolyhedronDifference</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *);
<a name="l00025"></a>00025 <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> * <a class="code" href="Zpolyhedron_8c.html#a9405cea5a362f28576f9a68a77a82ba0">ZPolyhedronImage</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *, <a class="code" href="structmatrix.html">Matrix</a> *);
<a name="l00026"></a>00026 <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> * <a class="code" href="Zpolyhedron_8c.html#a16289c71b1e52682c9e2dd35d425bf82">ZPolyhedronPreimage</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *, <a class="code" href="structmatrix.html">Matrix</a> *);
<a name="l00027"></a>00027 <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Head);
<a name="l00028"></a>00028 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#abdf4096040b073181ff38e741c329233">ZPolyhedronPrint</a>(FILE *fp, <span class="keyword">const</span> <span class="keywordtype">char</span> *format, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A);
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="structforsimplify.html">00030</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structforsimplify.html">forsimplify</a> {
<a name="l00031"></a><a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">00031</a>   <a class="code" href="structpolyhedron.html">Polyhedron</a> *<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a>;
<a name="l00032"></a><a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">00032</a>   <a class="code" href="structLatticeUnion.html">LatticeUnion</a> *<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>;
<a name="l00033"></a><a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">00033</a>   <span class="keyword">struct </span><a class="code" href="structforsimplify.html">forsimplify</a> *<a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">next</a>;
<a name="l00034"></a>00034 } <a class="code" href="Zpolyhedron_8c.html#a2dfb34403364e164ad6d119574b5f638">ForSimplify</a>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">/* </span>
<a name="l00038"></a>00038 <span class="comment"> * Returns True if &#39;Zpol&#39; is empty, otherwise returns False </span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a><a class="code" href="Zpolyhedron_8h.html#ab0afb5489d7025a2d231d1d769c74ffe">00040</a> <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol) {
<a name="l00041"></a>00041   
<a name="l00042"></a>00042   <span class="keywordflow">if</span>(Zpol == NULL)
<a name="l00043"></a>00043     <span class="keywordflow">return</span> <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00044"></a>00044   <span class="keywordflow">if</span>((<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a> (Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>)) || (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>)))
<a name="l00045"></a>00045     <span class="keywordflow">return</span> <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00046"></a>00046   <span class="keywordflow">return</span> <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;
<a name="l00047"></a>00047 } <span class="comment">/* isEmptyZPolyhedron */</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">/*</span>
<a name="l00050"></a>00050 <span class="comment"> * Given Lattice &#39;Lat&#39; and a Polyhderon &#39;Poly&#39;, allocate space, and return</span>
<a name="l00051"></a>00051 <span class="comment"> * the Z-polyhderon corresponding to the image of the polyhderon &#39;Poly&#39; by the </span>
<a name="l00052"></a>00052 <span class="comment"> * lattice &#39;Lat&#39;. If the input lattice &#39;Lat&#39; is not integeral, it integralises </span>
<a name="l00053"></a>00053 <span class="comment"> * it, i.e. the lattice of the Z-polyhderon returned is integeral. </span>
<a name="l00054"></a>00054 <span class="comment"> */</span> 
<a name="l00055"></a><a class="code" href="Zpolyhedron_8h.html#aea228bbc24564d06a571d0cae4303faa">00055</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(<a class="code" href="structmatrix.html">Lattice</a> *Lat, <a class="code" href="structpolyhedron.html">Polyhedron</a> *Poly) {
<a name="l00056"></a>00056   
<a name="l00057"></a>00057   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A;
<a name="l00058"></a>00058   
<a name="l00059"></a>00059   <a class="code" href="polyhedron_8h.html#a729f721c450a034c1219447745c6b123">POL_ENSURE_FACETS</a>(Poly);
<a name="l00060"></a>00060   <a class="code" href="polyhedron_8h.html#a317e5eb888f5c14e1229742f31169378">POL_ENSURE_VERTICES</a>(Poly);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <span class="keywordflow">if</span>(Lat-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != Poly-&gt;<a class="code" href="structpolyhedron.html#a2a02cea8b7ba3dde415041b8b2373bc8">Dimension</a>+1) {
<a name="l00063"></a>00063     fprintf(stderr,<span class="stringliteral">&quot;\nInZPolyAlloc - The Lattice  and the Polyhedron&quot;</span>);
<a name="l00064"></a>00064     fprintf(stderr,<span class="stringliteral">&quot; are not compatible to form a ZPolyhedra\n&quot;</span>);
<a name="l00065"></a>00065     <span class="keywordflow">return</span> NULL;
<a name="l00066"></a>00066   }  
<a name="l00067"></a>00067   <span class="keywordflow">if</span>((!(<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a>(Lat))) &amp;&amp; (!<a class="code" href="Lattice_8c.html#aa55a58802da206d773cbaf5d6ffb90a5">isfulldim</a> (Lat))) {
<a name="l00068"></a>00068     fprintf(stderr,<span class="stringliteral">&quot;\nZPolAlloc: Lattice not Full Dimensional\n&quot;</span>);
<a name="l00069"></a>00069     <span class="keywordflow">return</span> NULL;
<a name="l00070"></a>00070   }
<a name="l00071"></a>00071   A = (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a>));
<a name="l00072"></a>00072   <span class="keywordflow">if</span> (!A) {
<a name="l00073"></a>00073     fprintf(stderr,<span class="stringliteral">&quot;ZPolAlloc : Out of Memory\n&quot;</span>);
<a name="l00074"></a>00074     <span class="keywordflow">return</span> NULL;
<a name="l00075"></a>00075   } 
<a name="l00076"></a>00076   A-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = NULL;
<a name="l00077"></a>00077   A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a> = <a class="code" href="polyhedron_8c.html#ad57e191f32f3c9022ec00747f4908b3f">Domain_Copy</a>(Poly);
<a name="l00078"></a>00078   A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a> = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(Lat);
<a name="l00079"></a>00079   
<a name="l00080"></a>00080   <span class="keywordflow">if</span>(<a class="code" href="Lattice_8c.html#a2b6cf7c3438a407cd28d6ea0c9219d1b">IsLattice</a>(Lat) == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>) {
<a name="l00081"></a>00081     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Res;
<a name="l00082"></a>00082     
<a name="l00083"></a>00083     Res = <a class="code" href="Zpolyhedron_8c.html#a18679eb2fc30e66ff57146b427f3d7a8">IntegraliseLattice</a> (A);
<a name="l00084"></a>00084     <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (A);
<a name="l00085"></a>00085     <span class="keywordflow">return</span> Res;
<a name="l00086"></a>00086   }
<a name="l00087"></a>00087   <span class="keywordflow">return</span> A;
<a name="l00088"></a>00088 } <span class="comment">/* ZPolyhedron_Alloc */</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">/*</span>
<a name="l00091"></a>00091 <span class="comment"> * Free the memory used by the Z-domain &#39;Head&#39; </span>
<a name="l00092"></a>00092 <span class="comment"> */</span>
<a name="l00093"></a><a class="code" href="Zpolyhedron_8h.html#a4c358b8a8cc20a9ca35f76966ce20242">00093</a> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Head) {
<a name="l00094"></a>00094   
<a name="l00095"></a>00095   <span class="keywordflow">if</span> (Head == NULL)
<a name="l00096"></a>00096     <span class="keywordflow">return</span>;
<a name="l00097"></a>00097   <span class="keywordflow">if</span> (Head-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> != NULL)
<a name="l00098"></a>00098     <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a>(Head-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>);  
<a name="l00099"></a>00099   <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(Head);
<a name="l00100"></a>00100 } <span class="comment">/* ZDomain_Free */</span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="comment">/*</span>
<a name="l00103"></a>00103 <span class="comment"> * Free the memory used by the Z-polyhderon &#39;Zpol&#39; </span>
<a name="l00104"></a>00104 <span class="comment"> */</span>
<a name="l00105"></a><a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">00105</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol) {
<a name="l00106"></a>00106   
<a name="l00107"></a>00107   <span class="keywordflow">if</span> (Zpol == NULL)
<a name="l00108"></a>00108     <span class="keywordflow">return</span>;
<a name="l00109"></a>00109   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>((<a class="code" href="structmatrix.html">Matrix</a> *) Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>);
<a name="l00110"></a>00110   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>);
<a name="l00111"></a>00111   free(Zpol);
<a name="l00112"></a>00112   <span class="keywordflow">return</span>;
<a name="l00113"></a>00113 } <span class="comment">/* ZPolyhderon_Free */</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="comment">/*</span>
<a name="l00116"></a>00116 <span class="comment"> * Return a copy of the Z-domain &#39;Head&#39; </span>
<a name="l00117"></a>00117 <span class="comment"> */</span> 
<a name="l00118"></a><a class="code" href="Zpolyhedron_8h.html#adfc6db1caf4e0cbc2cbac31f2e076cfc">00118</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#adfc6db1caf4e0cbc2cbac31f2e076cfc">ZDomain_Copy</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Head) {
<a name="l00119"></a>00119   
<a name="l00120"></a>00120   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00121"></a>00121   Zpol = <a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">ZPolyhedron_Copy</a>(Head);
<a name="l00122"></a>00122   
<a name="l00123"></a>00123   <span class="keywordflow">if</span> (Head-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> != NULL)
<a name="l00124"></a>00124     Zpol-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = <a class="code" href="Zpolyhedron_8c.html#adfc6db1caf4e0cbc2cbac31f2e076cfc">ZDomain_Copy</a>(Head-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>);
<a name="l00125"></a>00125   <span class="keywordflow">return</span> Zpol;
<a name="l00126"></a>00126 } <span class="comment">/* ZDomain_Copy */</span>
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/*</span>
<a name="l00129"></a>00129 <span class="comment"> * Return a copy of the Z-polyhderon &#39;A&#39; </span>
<a name="l00130"></a>00130 <span class="comment"> */</span>
<a name="l00131"></a><a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">00131</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">ZPolyhedron_Copy</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A) {
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00134"></a>00134   
<a name="l00135"></a>00135   Zpol = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>, A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>);
<a name="l00136"></a>00136   <span class="keywordflow">return</span> Zpol;
<a name="l00137"></a>00137 } <span class="comment">/* ZPolyhderon_Copy */</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">/* </span>
<a name="l00140"></a>00140 <span class="comment"> * Add the ZPolyhedron &#39;Zpol&#39; to the Z-domain &#39;Result&#39; and return a pointer </span>
<a name="l00141"></a>00141 <span class="comment"> * to the new Z-domain. </span>
<a name="l00142"></a>00142 <span class="comment"> */</span>
<a name="l00143"></a><a class="code" href="Zpolyhedron_8c.html#a12543a0ea685af90e05e6ed5d1f45564">00143</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a12543a0ea685af90e05e6ed5d1f45564">AddZPoly2ZDomain</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result) {
<a name="l00144"></a>00144  
<a name="l00145"></a>00145   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A;
<a name="l00146"></a>00146   
<a name="l00147"></a>00147   <span class="keywordflow">if</span> (<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a>(Zpol))
<a name="l00148"></a>00148     <span class="keywordflow">return</span> Result;
<a name="l00149"></a>00149   A = <a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">ZPolyhedron_Copy</a>(Zpol);
<a name="l00150"></a>00150   A-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = NULL;
<a name="l00151"></a>00151   
<a name="l00152"></a>00152   <span class="keywordflow">if</span> (<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a> (Result)) {
<a name="l00153"></a>00153     <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a> (Result);
<a name="l00154"></a>00154     <span class="keywordflow">return</span> A;
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156   A-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = Result;  
<a name="l00157"></a>00157   <span class="keywordflow">return</span> A;
<a name="l00158"></a>00158 } <span class="comment">/* AddZPoly2ZDomain */</span>
<a name="l00159"></a>00159   
<a name="l00160"></a>00160 <span class="comment">/*</span>
<a name="l00161"></a>00161 <span class="comment"> * Given a Z-polyhderon &#39;A&#39; and a Z-domain &#39;Head&#39;, return a new Z-domain with </span>
<a name="l00162"></a>00162 <span class="comment"> * &#39;A&#39; added to it. If the new Z-polyhedron &#39;A&#39;, is already included in the </span>
<a name="l00163"></a>00163 <span class="comment"> * Z-domain &#39;Head&#39;, it is not added in the list. Othewise, the function checks </span>
<a name="l00164"></a>00164 <span class="comment"> * if the new Z-polyhedron &#39;A&#39; to be added to the Z-domain &#39;Head&#39; has a common</span>
<a name="l00165"></a>00165 <span class="comment"> * lattice with some other Z-polyhderon already present in the Z-domain. If it </span>
<a name="l00166"></a>00166 <span class="comment"> * is so, it takes the union of the underlying polyhdera; domains and returns. </span>
<a name="l00167"></a>00167 <span class="comment"> * The function tries to make sure that the added Z-polyhedron &#39;A&#39; is in the </span>
<a name="l00168"></a>00168 <span class="comment"> * canonical form.</span>
<a name="l00169"></a>00169 <span class="comment"> */</span>
<a name="l00170"></a><a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">00170</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Head) {
<a name="l00171"></a>00171   
<a name="l00172"></a>00172   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol, *temp, *temp1;
<a name="l00173"></a>00173   <a class="code" href="structpolyhedron.html">Polyhedron</a> *i;
<a name="l00174"></a>00174   <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> Added;  
<a name="l00175"></a>00175   
<a name="l00176"></a>00176   <span class="keywordflow">if</span> ((A == NULL) || (<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a>(A)))
<a name="l00177"></a>00177     <span class="keywordflow">return</span> Head;
<a name="l00178"></a>00178   
<a name="l00179"></a>00179   <span class="comment">/* For each &quot;underlying&quot; Pol, find the Cnf and add Zpol in Cnf*/</span>  
<a name="l00180"></a>00180   <span class="keywordflow">for</span>(i=A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>; i!= NULL; i=i-&gt;<a class="code" href="structpolyhedron.html#aab97126cb9e56431d40eaf4e68b3953d">next</a>) {
<a name="l00181"></a>00181     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Z, *Z1;
<a name="l00182"></a>00182     <a class="code" href="structpolyhedron.html">Polyhedron</a> *Image;
<a name="l00183"></a>00183     <a class="code" href="structmatrix.html">Matrix</a> *H, *U;
<a name="l00184"></a>00184     <a class="code" href="structmatrix.html">Lattice</a> *Lat ;
<a name="l00185"></a>00185     
<a name="l00186"></a>00186     Added = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;    
<a name="l00187"></a>00187     Image = <a class="code" href="polyhedron_8c.html#ad57e191f32f3c9022ec00747f4908b3f">Domain_Copy</a>(i);
<a name="l00188"></a>00188     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Image-&gt;<a class="code" href="structpolyhedron.html#aab97126cb9e56431d40eaf4e68b3953d">next</a>);
<a name="l00189"></a>00189     Image-&gt;<a class="code" href="structpolyhedron.html#aab97126cb9e56431d40eaf4e68b3953d">next</a> = NULL;
<a name="l00190"></a>00190     Z1 = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,Image);
<a name="l00191"></a>00191     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Image);
<a name="l00192"></a>00192     <a class="code" href="Zpolyhedron_8c.html#ae1596918aafc05f8d325722fbfa11d63">CanonicalForm</a>(Z1,&amp;Z,&amp;H); 
<a name="l00193"></a>00193     <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a>(Z1);
<a name="l00194"></a>00194     Lat = (<a class="code" href="structmatrix.html">Lattice</a> *)<a class="code" href="matrix_8c.html#ac0b29e1d99a2823ad00b5f2157879d80">Matrix_Alloc</a>(H-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>,Z-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>);
<a name="l00195"></a>00195     <a class="code" href="matrix_8c.html#a1e967c74adaa2eec868fd737a55b6624">Matrix_Product</a>(H,Z-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,(<a class="code" href="structmatrix.html">Matrix</a> *)Lat);
<a name="l00196"></a>00196     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(H);    
<a name="l00197"></a>00197     <a class="code" href="Lattice_8c.html#a4d75ea3bed92d944fc4be0ec7e08bd15">AffineHermite</a>(Lat,(<a class="code" href="structmatrix.html">Lattice</a> **)&amp;H,&amp;U);
<a name="l00198"></a>00198     Image = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(Z-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,U,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00199"></a>00199     <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a>(Z);
<a name="l00200"></a>00200       
<a name="l00201"></a>00201     Zpol=<a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>((<a class="code" href="structmatrix.html">Lattice</a> *)H,Image);     
<a name="l00202"></a>00202     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Image);
<a name="l00203"></a>00203     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>((<a class="code" href="structmatrix.html">Matrix</a> *)Lat);
<a name="l00204"></a>00204     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(H);
<a name="l00205"></a>00205     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(U);
<a name="l00206"></a>00206     
<a name="l00207"></a>00207     <span class="keywordflow">if</span> ((Head == NULL) || (<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a> (Head))) {
<a name="l00208"></a>00208       Head = Zpol;
<a name="l00209"></a>00209       <span class="keywordflow">continue</span>;
<a name="l00210"></a>00210     }     
<a name="l00211"></a>00211     temp1 = temp = Head;
<a name="l00212"></a>00212     
<a name="l00213"></a>00213     <span class="comment">/* Check if the curr pol is included in the zpol or vice versa. */</span>    
<a name="l00214"></a>00214     <span class="keywordflow">for</span>(; temp != NULL; temp = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00215"></a>00215       <span class="keywordflow">if</span> (<a class="code" href="Zpolyhedron_8c.html#aed98a7cbac0623890f53f62f3bec7807">ZPolyhedronIncludes</a>(Zpol, temp) == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l00216"></a>00216         <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (Zpol);
<a name="l00217"></a>00217         Added = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>; 
<a name="l00218"></a>00218         <span class="keywordflow">break</span>;
<a name="l00219"></a>00219       }
<a name="l00220"></a>00220       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Zpolyhedron_8c.html#aed98a7cbac0623890f53f62f3bec7807">ZPolyhedronIncludes</a>(temp, Zpol) == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l00221"></a>00221         <span class="keywordflow">if</span> (temp == Head) {
<a name="l00222"></a>00222           Zpol-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>;
<a name="l00223"></a>00223           Head = Zpol;
<a name="l00224"></a>00224           <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (temp);
<a name="l00225"></a>00225           Added = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00226"></a>00226           <span class="keywordflow">break</span>;
<a name="l00227"></a>00227         }       
<a name="l00228"></a>00228         temp1-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = Zpol;
<a name="l00229"></a>00229         Zpol-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>;
<a name="l00230"></a>00230         <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (temp);
<a name="l00231"></a>00231         Added = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00232"></a>00232         break ;
<a name="l00233"></a>00233       }
<a name="l00234"></a>00234       temp1 = temp ;
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236     <span class="keywordflow">if</span>(Added == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>)
<a name="l00237"></a>00237       continue ; 
<a name="l00238"></a>00238     <span class="keywordflow">for</span>(temp = Head; temp != NULL; temp = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00239"></a>00239       <span class="keywordflow">if</span>(<a class="code" href="Lattice_8c.html#aec768b41c299f9545319f655a3d2fd1a">sameLattice</a>(temp-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>, Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>) == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l00240"></a>00240         <a class="code" href="structpolyhedron.html">Polyhedron</a> *Union;
<a name="l00241"></a>00241         
<a name="l00242"></a>00242         Union = <a class="code" href="polyhedron_8c.html#a6e402792ade8ef5e83a87d623f03c5cb">DomainUnion</a> (temp-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00243"></a>00243         <span class="keywordflow">if</span> (!Union)
<a name="l00244"></a>00244           fprintf (stderr,<span class="stringliteral">&quot;\n In AddZPolytoZDomain: Out of memory\n&quot;</span>);
<a name="l00245"></a>00245         <span class="keywordflow">else</span> {
<a name="l00246"></a>00246           <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(temp-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>);
<a name="l00247"></a>00247           temp-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a> = Union;
<a name="l00248"></a>00248           Added = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00249"></a>00249           <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(Zpol);
<a name="l00250"></a>00250         }
<a name="l00251"></a>00251         break ; 
<a name="l00252"></a>00252       }
<a name="l00253"></a>00253       temp1 = temp;
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255     <span class="keywordflow">if</span> (Added == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>) 
<a name="l00256"></a>00256       temp1-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = Zpol;
<a name="l00257"></a>00257   }
<a name="l00258"></a>00258   <span class="keywordflow">return</span> Head ;  
<a name="l00259"></a>00259 } <span class="comment">/* AddZPolytoZDomain */</span>
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="comment">/*</span>
<a name="l00262"></a>00262 <span class="comment"> * Return the empty Z-polyhedron of dimension &#39;dimension&#39; </span>
<a name="l00263"></a>00263 <span class="comment"> */</span>
<a name="l00264"></a><a class="code" href="Zpolyhedron_8h.html#aa6461cb4a6bb43dd044c483570d632b5">00264</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(<span class="keywordtype">int</span> dimension) {
<a name="l00265"></a>00265 
<a name="l00266"></a>00266   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00267"></a>00267   <a class="code" href="structmatrix.html">Lattice</a> *E ;
<a name="l00268"></a>00268   <a class="code" href="structpolyhedron.html">Polyhedron</a> *P; 
<a name="l00269"></a>00269   
<a name="l00270"></a>00270 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00271"></a>00271 <span class="preprocessor"></span>  FILE *fp;
<a name="l00272"></a>00272   fp = fopen (<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00273"></a>00273   fprintf (fp, <span class="stringliteral">&quot;\nEntered EMPTYZPOLYHEDRON\n&quot;</span>);
<a name="l00274"></a>00274   fclose (fp);
<a name="l00275"></a>00275 <span class="preprocessor">#endif</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>
<a name="l00277"></a>00277   E = <a class="code" href="Lattice_8c.html#aab7550d1f894cc88fe630ce56f502184">EmptyLattice</a>(dimension+1);
<a name="l00278"></a>00278   P = <a class="code" href="polyhedron_8c.html#a37f19f6863a633aa08657cadf564d3d6">Empty_Polyhedron</a>(dimension);
<a name="l00279"></a>00279   Zpol = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(E,P);
<a name="l00280"></a>00280   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>((<a class="code" href="structmatrix.html">Matrix</a> *) E);
<a name="l00281"></a>00281   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(P);
<a name="l00282"></a>00282   <span class="keywordflow">return</span> Zpol;
<a name="l00283"></a>00283 } <span class="comment">/* EmptyZPolyhedron */</span>
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">/* </span>
<a name="l00286"></a>00286 <span class="comment"> * Given Z-domains &#39;A&#39; and &#39;B&#39;, return True if A is included in &#39;B&#39;, otherwise</span>
<a name="l00287"></a>00287 <span class="comment"> * return False.</span>
<a name="l00288"></a>00288 <span class="comment"> */</span>
<a name="l00289"></a><a class="code" href="Zpolyhedron_8h.html#a48e9670cd681b4f6af4b61c5fec3f4fd">00289</a> <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="Zpolyhedron_8c.html#a48e9670cd681b4f6af4b61c5fec3f4fd">ZDomainIncludes</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00290"></a>00290   
<a name="l00291"></a>00291   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Diff;
<a name="l00292"></a>00292   <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> ret = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;
<a name="l00293"></a>00293   
<a name="l00294"></a>00294   Diff = <a class="code" href="Zpolyhedron_8c.html#a97f1e11de3f03f0b346be8e882f2a44c">ZDomainDifference</a>(A,B);
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a>(Diff))
<a name="l00296"></a>00296     ret = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00297"></a>00297   
<a name="l00298"></a>00298   <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a>(Diff);
<a name="l00299"></a>00299   <span class="keywordflow">return</span> ret;
<a name="l00300"></a>00300 } <span class="comment">/* ZDomainIncludes */</span>
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="comment">/* </span>
<a name="l00303"></a>00303 <span class="comment"> * Given Z-polyhedra &#39;A&#39; and &#39;B&#39;, return True if &#39;A&#39; is included in &#39;B&#39;, </span>
<a name="l00304"></a>00304 <span class="comment"> * otherwise return False </span>
<a name="l00305"></a>00305 <span class="comment"> */</span>
<a name="l00306"></a><a class="code" href="Zpolyhedron_8h.html#aed98a7cbac0623890f53f62f3bec7807">00306</a> <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="Zpolyhedron_8c.html#aed98a7cbac0623890f53f62f3bec7807">ZPolyhedronIncludes</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   <a class="code" href="structpolyhedron.html">Polyhedron</a> *Diff = NULL ;
<a name="l00309"></a>00309   <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> retval = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00312"></a>00312 <span class="preprocessor"></span>  FILE *fp;
<a name="l00313"></a>00313   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>);
<a name="l00314"></a>00314   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZPOLYHEDRONINCLUDES\n&quot;</span>);
<a name="l00315"></a>00315   fclose(fp);
<a name="l00316"></a>00316 <span class="preprocessor">#endif</span>
<a name="l00317"></a>00317 <span class="preprocessor"></span>  
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (<a class="code" href="Lattice_8c.html#abe494c899b1c641aedcb95fec4719070">LatticeIncludes</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>, B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>) == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l00319"></a>00319     <a class="code" href="structpolyhedron.html">Polyhedron</a> *ImageA, *ImageB ;
<a name="l00320"></a>00320     
<a name="l00321"></a>00321     ImageA = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00322"></a>00322     ImageB = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(B-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00323"></a>00323       
<a name="l00324"></a>00324     Diff = <a class="code" href="polyhedron_8c.html#aaaefa8685a2b2819b9863f2e4ff427f5">DomainDifference</a>(ImageA, ImageB, <a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00325"></a>00325     <span class="keywordflow">if</span>(<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a> (Diff))
<a name="l00326"></a>00326       retval = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a> ;
<a name="l00327"></a>00327     
<a name="l00328"></a>00328     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (ImageA);
<a name="l00329"></a>00329     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (ImageB);
<a name="l00330"></a>00330     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (Diff);
<a name="l00331"></a>00331   }  
<a name="l00332"></a>00332   <span class="keywordflow">return</span> retval;
<a name="l00333"></a>00333 } <span class="comment">/* ZPolyhedronIncludes */</span> 
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="comment">/*</span>
<a name="l00336"></a>00336 <span class="comment"> * Print the contents of a Z-domain &#39;A&#39; </span>
<a name="l00337"></a>00337 <span class="comment"> */</span>
<a name="l00338"></a><a class="code" href="Zpolyhedron_8h.html#a77aed9aa9a109db0a32d453421a9fed9">00338</a> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#a77aed9aa9a109db0a32d453421a9fed9">ZDomainPrint</a>(FILE *fp, <span class="keyword">const</span> <span class="keywordtype">char</span> *format, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A)
<a name="l00339"></a>00339 {
<a name="l00340"></a>00340 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span>  FILE *fp1;
<a name="l00342"></a>00342   fp1 = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00343"></a>00343   fprintf(fp1,<span class="stringliteral">&quot;\nEntered ZDOMAINPRINT\n&quot;</span>);
<a name="l00344"></a>00344   fclose(fp1);
<a name="l00345"></a>00345 <span class="preprocessor">#endif</span>
<a name="l00346"></a>00346 <span class="preprocessor"></span>  
<a name="l00347"></a>00347   <a class="code" href="Zpolyhedron_8c.html#abdf4096040b073181ff38e741c329233">ZPolyhedronPrint</a>(fp,format,A);
<a name="l00348"></a>00348   <span class="keywordflow">if</span> (A-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> != NULL) {
<a name="l00349"></a>00349     fprintf(fp,<span class="stringliteral">&quot;\nUNIONED with\n&quot;</span>);
<a name="l00350"></a>00350     <a class="code" href="Zpolyhedron_8c.html#a77aed9aa9a109db0a32d453421a9fed9">ZDomainPrint</a>(fp,format,A-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>);
<a name="l00351"></a>00351   }
<a name="l00352"></a>00352   <span class="keywordflow">return</span>;
<a name="l00353"></a>00353 } <span class="comment">/* ZDomainPrint */</span>  
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">/*</span>
<a name="l00356"></a>00356 <span class="comment"> * Print the contents of a ZPolyhderon &#39;A&#39;</span>
<a name="l00357"></a>00357 <span class="comment"> */</span>
<a name="l00358"></a><a class="code" href="Zpolyhedron_8c.html#abdf4096040b073181ff38e741c329233">00358</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#abdf4096040b073181ff38e741c329233">ZPolyhedronPrint</a> (FILE *fp, <span class="keyword">const</span> <span class="keywordtype">char</span> *format, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A)
<a name="l00359"></a>00359 {
<a name="l00360"></a>00360   <span class="keywordflow">if</span> (A == NULL)
<a name="l00361"></a>00361     return ;
<a name="l00362"></a>00362   fprintf(fp,<span class="stringliteral">&quot;\nZPOLYHEDRON: Dimension %d \n&quot;</span>,A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1);
<a name="l00363"></a>00363   fprintf(fp, <span class="stringliteral">&quot;\nLATTICE: \n&quot;</span>);
<a name="l00364"></a>00364   <a class="code" href="matrix_8c.html#ad4c3c350dba633f72bbcf3609b6b67d7">Matrix_Print</a>(fp,format,(<a class="code" href="structmatrix.html">Matrix</a> *)A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>);
<a name="l00365"></a>00365   <a class="code" href="polyhedron_8c.html#ad87595bd01c5cdd0f3933824943db496">Polyhedron_Print</a>(fp,format,A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>);  
<a name="l00366"></a>00366   <span class="keywordflow">return</span>;
<a name="l00367"></a>00367 } <span class="comment">/* ZPolyhedronPrint */</span>
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 <span class="comment">/*</span>
<a name="l00370"></a>00370 <span class="comment"> * Return the Z-domain union of the Z-domain &#39;A&#39; and &#39;B&#39;. The dimensions of the</span>
<a name="l00371"></a>00371 <span class="comment"> * Z-domains &#39;A&#39; and &#39;B&#39; must be equal. All the Z-polyhedra of the resulting </span>
<a name="l00372"></a>00372 <span class="comment"> * union are expected to be in Canonical forms.</span>
<a name="l00373"></a>00373 <span class="comment"> */</span>
<a name="l00374"></a><a class="code" href="Zpolyhedron_8h.html#aeb4a3836b97a8283580c03d3cc71ed00">00374</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#aeb4a3836b97a8283580c03d3cc71ed00">ZDomainUnion</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00375"></a>00375   
<a name="l00376"></a>00376   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL, *temp;
<a name="l00377"></a>00377   
<a name="l00378"></a>00378 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00379"></a>00379 <span class="preprocessor"></span>  FILE *fp;
<a name="l00380"></a>00380   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00381"></a>00381   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZDOMAINUNION\n&quot;</span>);
<a name="l00382"></a>00382   fclose(fp);
<a name="l00383"></a>00383 <span class="preprocessor">#endif</span>
<a name="l00384"></a>00384 <span class="preprocessor"></span>
<a name="l00385"></a>00385   <span class="keywordflow">for</span>(temp = A; temp != NULL; temp = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>)
<a name="l00386"></a>00386     Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(temp, Result); 
<a name="l00387"></a>00387   <span class="keywordflow">for</span>(temp = B; temp != NULL; temp = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> )
<a name="l00388"></a>00388     Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(temp, Result);
<a name="l00389"></a>00389   <span class="keywordflow">return</span> Result;
<a name="l00390"></a>00390 } <span class="comment">/* ZDomainUnion */</span>
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="comment">/* </span>
<a name="l00393"></a>00393 <span class="comment"> * Return the Z-domain intersection of the Z-domains &#39;A&#39; and &#39;B&#39;.The dimensions</span>
<a name="l00394"></a>00394 <span class="comment"> * of domains &#39;A&#39; and &#39;B&#39; must be equal. </span>
<a name="l00395"></a>00395 <span class="comment"> */</span>
<a name="l00396"></a><a class="code" href="Zpolyhedron_8h.html#a0f747089a4e82c008210f9cf959643ee">00396</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a0f747089a4e82c008210f9cf959643ee">ZDomainIntersection</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00397"></a>00397   
<a name="l00398"></a>00398   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL, *tempA = NULL, *tempB = NULL;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00401"></a>00401 <span class="preprocessor"></span>  FILE *fp;
<a name="l00402"></a>00402   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00403"></a>00403   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZDOMAININTERSECTION\n&quot;</span>);
<a name="l00404"></a>00404   fclose(fp);
<a name="l00405"></a>00405 <span class="preprocessor">#endif  </span>
<a name="l00406"></a>00406 <span class="preprocessor"></span>  
<a name="l00407"></a>00407   <span class="keywordflow">for</span>(tempA = A; tempA != NULL; tempA = tempA-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>)
<a name="l00408"></a>00408     <span class="keywordflow">for</span>(tempB = B; tempB != NULL; tempB = tempB-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00409"></a>00409       <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00410"></a>00410       Zpol = <a class="code" href="Zpolyhedron_8c.html#a342b4aae95e1b5fcd31bde39de7e5676">ZPolyhedronIntersection</a>(tempA, tempB);
<a name="l00411"></a>00411       Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(Zpol, Result );
<a name="l00412"></a>00412       <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (Zpol);
<a name="l00413"></a>00413     }
<a name="l00414"></a>00414   <span class="keywordflow">if</span> (Result == NULL)
<a name="l00415"></a>00415     <span class="keywordflow">return</span> <a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a> (A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1);
<a name="l00416"></a>00416   <span class="keywordflow">return</span> Result;
<a name="l00417"></a>00417 } <span class="comment">/* ZDomainIntersection */</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="comment">/*</span>
<a name="l00420"></a>00420 <span class="comment"> * Return the Z-domain difference of the domains &#39;A&#39; and &#39;B&#39;. The dimensions of</span>
<a name="l00421"></a>00421 <span class="comment"> * the Z-domains &#39;A&#39; and &#39;B&#39; must be equal. Note that the difference of two </span>
<a name="l00422"></a>00422 <span class="comment"> * Z-polyhedra is a Union of Z-polyhedra. The algorithms is as given below :-</span>
<a name="l00423"></a>00423 <span class="comment"> * Algorithm: (Given Z-domains A and B)</span>
<a name="l00424"></a>00424 <span class="comment"> *           Result &lt;-- NULL</span>
<a name="l00425"></a>00425 <span class="comment"> *           for every Z-polyhderon Zpoly of A {</span>
<a name="l00426"></a>00426 <span class="comment"> *               temp &lt;-- Zpoly;</span>
<a name="l00427"></a>00427 <span class="comment"> *               for every Z-polyhderon Z1 of B</span>
<a name="l00428"></a>00428 <span class="comment"> *                  temp = temp - Z1;</span>
<a name="l00429"></a>00429 <span class="comment"> *               }</span>
<a name="l00430"></a>00430 <span class="comment"> *           Add temp to Result;</span>
<a name="l00431"></a>00431 <span class="comment"> *           return;</span>
<a name="l00432"></a>00432 <span class="comment"> */</span>
<a name="l00433"></a><a class="code" href="Zpolyhedron_8h.html#a97f1e11de3f03f0b346be8e882f2a44c">00433</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a97f1e11de3f03f0b346be8e882f2a44c">ZDomainDifference</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a>  *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00434"></a>00434   
<a name="l00435"></a>00435   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL, *tempA = NULL, *tempB = NULL;
<a name="l00436"></a>00436   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *templist, *res, *i, *j;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span>  FILE *fp;
<a name="l00440"></a>00440   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00441"></a>00441   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZDOMAINDIFFERENCE\n&quot;</span>);
<a name="l00442"></a>00442   fclose(fp);
<a name="l00443"></a>00443 <span class="preprocessor">#endif</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span>  
<a name="l00445"></a>00445   <span class="keywordflow">if</span> (A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>) {
<a name="l00446"></a>00446     fprintf(stderr, <span class="stringliteral">&quot;In ZDomainDifference : the input ZDomains &quot;</span>);
<a name="l00447"></a>00447     fprintf(stderr, <span class="stringliteral">&quot;do not have compatible dimensions\n&quot;</span>);
<a name="l00448"></a>00448     fprintf(stderr, <span class="stringliteral">&quot;ZDomainDifference not performed\n&quot;</span>);
<a name="l00449"></a>00449     <span class="keywordflow">return</span> NULL;
<a name="l00450"></a>00450   }
<a name="l00451"></a>00451   
<a name="l00452"></a>00452   <span class="keywordflow">for</span>(tempA = A; tempA != NULL; tempA = tempA-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00453"></a>00453     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *temp = NULL;
<a name="l00454"></a>00454     temp = <a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">ZPolyhedron_Copy</a>(tempA);
<a name="l00455"></a>00455     
<a name="l00456"></a>00456     <span class="keywordflow">for</span>(tempB = B; tempB != NULL; tempB = tempB-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00457"></a>00457       templist = NULL; res = NULL;
<a name="l00458"></a>00458       <span class="keywordflow">for</span>(i = temp; i != NULL; i = i-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00459"></a>00459         res = <a class="code" href="Zpolyhedron_8c.html#a07af455469e4301a457a5e0265a6d545">ZPolyhedronDifference</a>(i,tempB);
<a name="l00460"></a>00460         <span class="keywordflow">for</span> (j = res; j != NULL; j = j-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> )
<a name="l00461"></a>00461           templist = <a class="code" href="Zpolyhedron_8c.html#a12543a0ea685af90e05e6ed5d1f45564">AddZPoly2ZDomain</a>(j,templist);
<a name="l00462"></a>00462         <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a>(res);
<a name="l00463"></a>00463       }
<a name="l00464"></a>00464       <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a> (temp);
<a name="l00465"></a>00465       temp = NULL; 
<a name="l00466"></a>00466       <span class="keywordflow">for</span>(i = templist; i != NULL; i = i-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>)
<a name="l00467"></a>00467         temp = <a class="code" href="Zpolyhedron_8c.html#a12543a0ea685af90e05e6ed5d1f45564">AddZPoly2ZDomain</a>(i, temp);
<a name="l00468"></a>00468       <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a> (templist);
<a name="l00469"></a>00469     }
<a name="l00470"></a>00470     <span class="keywordflow">for</span>(i = temp; i != NULL; i = i-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>)
<a name="l00471"></a>00471       Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(i, Result);
<a name="l00472"></a>00472     <a class="code" href="Zpolyhedron_8c.html#a4c358b8a8cc20a9ca35f76966ce20242">ZDomain_Free</a>(temp);    
<a name="l00473"></a>00473   }
<a name="l00474"></a>00474   <span class="keywordflow">if</span> (Result==NULL)
<a name="l00475"></a>00475     <span class="keywordflow">return</span> (<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1));
<a name="l00476"></a>00476   <span class="keywordflow">return</span> Result;
<a name="l00477"></a>00477 } <span class="comment">/* ZDomainDifference */</span>
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="comment">/*</span>
<a name="l00480"></a>00480 <span class="comment"> * Return the image of the Z-domain &#39;A&#39; under the invertible, affine, rational</span>
<a name="l00481"></a>00481 <span class="comment"> * transformation function &#39;Func&#39;. The matrix representing the function &#39;Func&#39;</span>
<a name="l00482"></a>00482 <span class="comment"> * must be non-singular and the number of rows of the function must be equal</span>
<a name="l00483"></a>00483 <span class="comment"> * to the number of rows in the matrix representing the lattice of &#39;A&#39;. </span>
<a name="l00484"></a>00484 <span class="comment"> * Note:: Image((Z1 U Z2),F) = Image(Z1,F) U Image(Z2 U F).</span>
<a name="l00485"></a>00485 <span class="comment"> */</span>
<a name="l00486"></a><a class="code" href="Zpolyhedron_8h.html#a15cca433d2f4720b50b582177d500159">00486</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a15cca433d2f4720b50b582177d500159">ZDomainImage</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structmatrix.html">Matrix</a> *Func) {
<a name="l00487"></a>00487 
<a name="l00488"></a>00488   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL, *temp;
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00491"></a>00491 <span class="preprocessor"></span>  FILE *fp;
<a name="l00492"></a>00492   fp = fopen (<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00493"></a>00493   fprintf (fp, <span class="stringliteral">&quot;\nEntered ZDOMAINIMAGE\n&quot;</span>);
<a name="l00494"></a>00494   fclose (fp);
<a name="l00495"></a>00495 <span class="preprocessor">#endif  </span>
<a name="l00496"></a>00496 <span class="preprocessor"></span>  
<a name="l00497"></a>00497   <span class="keywordflow">for</span>(temp = A; temp != NULL; temp = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {
<a name="l00498"></a>00498     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00499"></a>00499     Zpol =  <a class="code" href="Zpolyhedron_8c.html#a9405cea5a362f28576f9a68a77a82ba0">ZPolyhedronImage</a> (temp, Func);
<a name="l00500"></a>00500     Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a> (Zpol, Result);
<a name="l00501"></a>00501     <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (Zpol);
<a name="l00502"></a>00502   }  
<a name="l00503"></a>00503   <span class="keywordflow">if</span>(Result == NULL)
<a name="l00504"></a>00504     <span class="keywordflow">return</span> <a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1);  
<a name="l00505"></a>00505   <span class="keywordflow">return</span> Result;
<a name="l00506"></a>00506 } <span class="comment">/* ZDomainImage */</span> 
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="comment">/*</span>
<a name="l00509"></a>00509 <span class="comment"> * Return the preimage of the Z-domain &#39;A&#39; under the invertible, affine, ratio-</span>
<a name="l00510"></a>00510 <span class="comment"> * nal transformation &#39;Func&#39;. The number of rows of the matrix representing </span>
<a name="l00511"></a>00511 <span class="comment"> * the function &#39;Func&#39; must be equal to the number of rows of the matrix repr-</span>
<a name="l00512"></a>00512 <span class="comment"> * senting the lattice of &#39;A&#39;.  </span>
<a name="l00513"></a>00513 <span class="comment"> */</span>
<a name="l00514"></a><a class="code" href="Zpolyhedron_8h.html#a7d35f2d725d25c1f2baf113c74d82f2c">00514</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a7d35f2d725d25c1f2baf113c74d82f2c">ZDomainPreimage</a> (<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structmatrix.html">Matrix</a> *Func) {
<a name="l00515"></a>00515 
<a name="l00516"></a>00516   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL, *temp ;
<a name="l00517"></a>00517   
<a name="l00518"></a>00518 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00519"></a>00519 <span class="preprocessor"></span>  FILE *fp;
<a name="l00520"></a>00520   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00521"></a>00521   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZDOMAINPREIMAGE\n&quot;</span>);
<a name="l00522"></a>00522   fclose(fp);
<a name="l00523"></a>00523 <span class="preprocessor">#endif</span>
<a name="l00524"></a>00524 <span class="preprocessor"></span>  
<a name="l00525"></a>00525   <span class="keywordflow">if</span> (A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != Func-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>) {
<a name="l00526"></a>00526     fprintf(stderr,<span class="stringliteral">&quot;\nError : In ZDomainPreimage, &quot;</span>);
<a name="l00527"></a>00527     fprintf(stderr,<span class="stringliteral">&quot;Incompatible dimensions of ZPolyhedron &quot;</span>);
<a name="l00528"></a>00528     fprintf(stderr,<span class="stringliteral">&quot;and the Function \n&quot;</span>);
<a name="l00529"></a>00529     <span class="keywordflow">return</span>(<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(Func-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1)); 
<a name="l00530"></a>00530   }  
<a name="l00531"></a>00531   <span class="keywordflow">for</span>(temp = A; temp != NULL; temp = temp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>) {       
<a name="l00532"></a>00532     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00533"></a>00533     Zpol = <a class="code" href="Zpolyhedron_8c.html#a16289c71b1e52682c9e2dd35d425bf82">ZPolyhedronPreimage</a>(temp, Func);
<a name="l00534"></a>00534     Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(Zpol, Result);
<a name="l00535"></a>00535     <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(Zpol);
<a name="l00536"></a>00536   }  
<a name="l00537"></a>00537   <span class="keywordflow">if</span> (Result == NULL)
<a name="l00538"></a>00538     <span class="keywordflow">return</span>(<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(Func-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1));
<a name="l00539"></a>00539   <span class="keywordflow">return</span> Result;   
<a name="l00540"></a>00540 } <span class="comment">/* ZDomainPreimage */</span> 
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="comment">/*</span>
<a name="l00543"></a>00543 <span class="comment"> * Return the Z-polyhedron intersection of the Z-polyhedra &#39;A&#39; and &#39;B&#39;. </span>
<a name="l00544"></a>00544 <span class="comment"> * Note: If Z1 = L1 (intersect) P1 and Z2 = L2 (intersect) P2, then </span>
<a name="l00545"></a>00545 <span class="comment"> *     Z1 (intersect) Z2 = (L1 (intersect) L2) (intersect) (P1 (intersect) P2) </span>
<a name="l00546"></a>00546 <span class="comment"> */</span>
<a name="l00547"></a><a class="code" href="Zpolyhedron_8c.html#a342b4aae95e1b5fcd31bde39de7e5676">00547</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a342b4aae95e1b5fcd31bde39de7e5676">ZPolyhedronIntersection</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00548"></a>00548   
<a name="l00549"></a>00549   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL;
<a name="l00550"></a>00550   <a class="code" href="structmatrix.html">Lattice</a> *LInter;
<a name="l00551"></a>00551   <a class="code" href="structpolyhedron.html">Polyhedron</a> *PInter, *ImageA, *ImageB, *PreImage;
<a name="l00552"></a>00552   
<a name="l00553"></a>00553 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00554"></a>00554 <span class="preprocessor"></span>  FILE *fp;
<a name="l00555"></a>00555   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>);
<a name="l00556"></a>00556   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZPOLYHEDRONINTERSECTION\n&quot;</span>);
<a name="l00557"></a>00557   fclose(fp);
<a name="l00558"></a>00558 <span class="preprocessor">#endif  </span>
<a name="l00559"></a>00559 <span class="preprocessor"></span>  
<a name="l00560"></a>00560   LInter = <a class="code" href="Lattice_8c.html#adb689baac30514102da4520b751c199d">LatticeIntersection</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>);
<a name="l00561"></a>00561   <span class="keywordflow">if</span>(<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a>(LInter) == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l00562"></a>00562     <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a> (Result);
<a name="l00563"></a>00563     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(LInter);
<a name="l00564"></a>00564     <span class="keywordflow">return</span> (<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1));
<a name="l00565"></a>00565   }  
<a name="l00566"></a>00566   ImageA = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00567"></a>00567   ImageB = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(B-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00568"></a>00568   PInter = <a class="code" href="polyhedron_8c.html#ac5a1a2751f0b833183560af25b18033b">DomainIntersection</a>(ImageA,ImageB,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>); 
<a name="l00569"></a>00569   <span class="keywordflow">if</span> (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(PInter))
<a name="l00570"></a>00570     Result = <a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(LInter-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1);
<a name="l00571"></a>00571   <span class="keywordflow">else</span> { 
<a name="l00572"></a>00572     PreImage = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(PInter,(<a class="code" href="structmatrix.html">Matrix</a> *)LInter,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00573"></a>00573     Result = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(LInter, PreImage);    
<a name="l00574"></a>00574     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (PreImage);
<a name="l00575"></a>00575   }  
<a name="l00576"></a>00576   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(LInter);
<a name="l00577"></a>00577   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(PInter); 
<a name="l00578"></a>00578   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(ImageA);
<a name="l00579"></a>00579   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(ImageB);  
<a name="l00580"></a>00580   <span class="keywordflow">return</span> Result ;
<a name="l00581"></a>00581 } <span class="comment">/* ZPolyhedronIntersection */</span> 
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">/* </span>
<a name="l00584"></a>00584 <span class="comment"> * Return the difference of the two Z-polyhedra &#39;A&#39; and &#39;B&#39;. Below is the </span>
<a name="l00585"></a>00585 <span class="comment"> * procedure to find the difference of &#39;A&#39; and &#39;B&#39; :-</span>
<a name="l00586"></a>00586 <span class="comment"> * Procedure: </span>
<a name="l00587"></a>00587 <span class="comment"> *     Let A = L1 (intersect) P1&#39; and B = L2 (intersect) P2&#39; where </span>
<a name="l00588"></a>00588 <span class="comment"> *     (P1&#39; = DomImage(P1,L1) and P2&#39; = DomImage(P2,L2)). Then </span>
<a name="l00589"></a>00589 <span class="comment"> *     A-B = L1 (intersect) (P1&#39;-P2&#39;) Union </span>
<a name="l00590"></a>00590 <span class="comment"> *           (L1-L2) (intersect) (P1&#39; (intersect) P2&#39;)</span>
<a name="l00591"></a>00591 <span class="comment"> */</span> 
<a name="l00592"></a><a class="code" href="Zpolyhedron_8c.html#a07af455469e4301a457a5e0265a6d545">00592</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a07af455469e4301a457a5e0265a6d545">ZPolyhedronDifference</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A, <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *B) {
<a name="l00593"></a>00593   
<a name="l00594"></a>00594   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL ;
<a name="l00595"></a>00595   <a class="code" href="structLatticeUnion.html">LatticeUnion</a> *LatDiff, *temp;
<a name="l00596"></a>00596   <a class="code" href="structpolyhedron.html">Polyhedron</a> *DomDiff, *DomInter, *PreImage, *ImageA, *ImageB;
<a name="l00597"></a>00597   <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> flag = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00600"></a>00600 <span class="preprocessor"></span>  FILE *fp;
<a name="l00601"></a>00601   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00602"></a>00602   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZPOLYHEDRONDIFFERENCE\n&quot;</span>);
<a name="l00603"></a>00603   fclose(fp);
<a name="l00604"></a>00604 <span class="preprocessor">#endif</span>
<a name="l00605"></a>00605 <span class="preprocessor"></span>
<a name="l00606"></a>00606   <span class="keywordflow">if</span>(<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a> (A))
<a name="l00607"></a>00607     <span class="keywordflow">return</span> NULL;
<a name="l00608"></a>00608   <span class="keywordflow">if</span>(<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a> (B)) {
<a name="l00609"></a>00609     Result = <a class="code" href="Zpolyhedron_8c.html#adfc6db1caf4e0cbc2cbac31f2e076cfc">ZDomain_Copy</a> (A);
<a name="l00610"></a>00610     <span class="keywordflow">return</span> Result;
<a name="l00611"></a>00611   }  
<a name="l00612"></a>00612   ImageA = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,(<a class="code" href="structmatrix.html">Matrix</a> *)A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00613"></a>00613   ImageB = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(B-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,(<a class="code" href="structmatrix.html">Matrix</a> *)B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);  
<a name="l00614"></a>00614   DomDiff = <a class="code" href="polyhedron_8c.html#aaaefa8685a2b2819b9863f2e4ff427f5">DomainDifference</a>(ImageA,ImageB,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00615"></a>00615   <span class="keywordflow">if</span> (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a> (DomDiff))
<a name="l00616"></a>00616     flag = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;
<a name="l00617"></a>00617   <span class="keywordflow">else</span> {
<a name="l00618"></a>00618     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Z;
<a name="l00619"></a>00619     PreImage = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(DomDiff,A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00620"></a>00620     Z = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,PreImage);    
<a name="l00621"></a>00621     Result = <a class="code" href="Zpolyhedron_8c.html#ad5c4dbaa587f00447836e0b7d8f33c65">AddZPolytoZDomain</a>(Z,Result);
<a name="l00622"></a>00622   }  
<a name="l00623"></a>00623   <span class="keywordflow">if</span> (flag == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>)  <span class="comment">/* DomDiff = NULL; DomInter = A */</span>
<a name="l00624"></a>00624     DomInter = <a class="code" href="polyhedron_8c.html#ad57e191f32f3c9022ec00747f4908b3f">Domain_Copy</a>(ImageA);
<a name="l00625"></a>00625   <span class="keywordflow">else</span> {
<a name="l00626"></a>00626     DomInter = <a class="code" href="polyhedron_8c.html#ac5a1a2751f0b833183560af25b18033b">DomainIntersection</a>(ImageA,ImageB,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00627"></a>00627     <span class="keywordflow">if</span> (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(DomInter)) {
<a name="l00628"></a>00628       <span class="keywordflow">if</span> (flag == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>)
<a name="l00629"></a>00629         <span class="keywordflow">return</span> (<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1));
<a name="l00630"></a>00630       <span class="keywordflow">else</span>
<a name="l00631"></a>00631         <span class="keywordflow">return</span> Result;
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633   }  
<a name="l00634"></a>00634   LatDiff = <a class="code" href="Lattice_8c.html#a31fa008ccc3304ba29e3167b17c61b70" title="Method :">LatticeDifference</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>, B-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>);
<a name="l00635"></a>00635   <span class="keywordflow">if</span>(LatDiff == NULL)
<a name="l00636"></a>00636     <span class="keywordflow">if</span>(flag == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a> )
<a name="l00637"></a>00637       <span class="keywordflow">return</span>(<a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a> (A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1));
<a name="l00638"></a>00638   
<a name="l00639"></a>00639   <span class="keywordflow">while</span> (LatDiff != NULL) {
<a name="l00640"></a>00640     <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *tempZ = NULL;
<a name="l00641"></a>00641     
<a name="l00642"></a>00642     PreImage = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(DomInter, LatDiff-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a>, <a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);    
<a name="l00643"></a>00643     tempZ = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(LatDiff-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a>, PreImage);
<a name="l00644"></a>00644     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(PreImage);
<a name="l00645"></a>00645     Result = <a class="code" href="Zpolyhedron_8c.html#a12543a0ea685af90e05e6ed5d1f45564">AddZPoly2ZDomain</a>(tempZ,Result);
<a name="l00646"></a>00646     <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(tempZ);
<a name="l00647"></a>00647     temp = LatDiff;
<a name="l00648"></a>00648     LatDiff = LatDiff-&gt;<a class="code" href="structLatticeUnion.html#ab21274825bf2e44967e1fcf6f42bcd88">next</a>;  
<a name="l00649"></a>00649     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> ((<a class="code" href="structmatrix.html">Matrix</a> *) temp-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a>);
<a name="l00650"></a>00650     free (temp);
<a name="l00651"></a>00651   }  
<a name="l00652"></a>00652   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (DomInter);
<a name="l00653"></a>00653   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (DomDiff);
<a name="l00654"></a>00654   <span class="keywordflow">return</span> Result;
<a name="l00655"></a>00655 } <span class="comment">/* ZPolyhedronDifference */</span> 
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 <span class="comment">/*</span>
<a name="l00658"></a>00658 <span class="comment"> * Return the image of the Z-polyhedron &#39;ZPol&#39; under the invertible, affine, </span>
<a name="l00659"></a>00659 <span class="comment"> * rational transformation function &#39;Func&#39;. The matrix representing the funct-</span>
<a name="l00660"></a>00660 <span class="comment"> * ion must be non-singular and the number of rows of the function must be </span>
<a name="l00661"></a>00661 <span class="comment"> * equal to the number of rows in the matrix representing the lattice of &#39;ZPol&#39;</span>
<a name="l00662"></a>00662 <span class="comment"> * Algorithm: </span>
<a name="l00663"></a>00663 <span class="comment"> *         1)  Let ZPol = L (intersect) Q</span>
<a name="l00664"></a>00664 <span class="comment"> *         2)  L1 = LatticeImage(L,F)</span>
<a name="l00665"></a>00665 <span class="comment"> *         3)  Q1 = DomainImage(Q,F)</span>
<a name="l00666"></a>00666 <span class="comment"> *         4)  Z1 = L1(Inverse(L1)*Q1)</span>
<a name="l00667"></a>00667 <span class="comment"> *         5)  Return Z1</span>
<a name="l00668"></a>00668 <span class="comment"> */</span>
<a name="l00669"></a><a class="code" href="Zpolyhedron_8c.html#a9405cea5a362f28576f9a68a77a82ba0">00669</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a9405cea5a362f28576f9a68a77a82ba0">ZPolyhedronImage</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *ZPol,<a class="code" href="structmatrix.html">Matrix</a> *Func) {
<a name="l00670"></a>00670  
<a name="l00671"></a>00671   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result = NULL ;
<a name="l00672"></a>00672   <a class="code" href="structmatrix.html">Matrix</a> *LatIm ;
<a name="l00673"></a>00673   <a class="code" href="structpolyhedron.html">Polyhedron</a> *<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a>, *PolImage ; 
<a name="l00674"></a>00674   
<a name="l00675"></a>00675 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00676"></a>00676 <span class="preprocessor"></span>  FILE *fp;
<a name="l00677"></a>00677   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00678"></a>00678   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZPOLYHEDRONIMAGE\n&quot;</span>);
<a name="l00679"></a>00679   fclose(fp);
<a name="l00680"></a>00680 <span class="preprocessor">#endif</span>
<a name="l00681"></a>00681 <span class="preprocessor"></span>  
<a name="l00682"></a>00682   <span class="keywordflow">if</span> ((Func-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>) || (Func-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a> != ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>)) {
<a name="l00683"></a>00683     fprintf (stderr, <span class="stringliteral">&quot;In ZPolImage - The Function, is not compatible with the ZPolyhedron\n&quot;</span>);
<a name="l00684"></a>00684     <span class="keywordflow">return</span> NULL;
<a name="l00685"></a>00685   }
<a name="l00686"></a>00686   LatIm = <a class="code" href="Lattice_8c.html#ac67608cf4d08c51aa76da79051507fd4">LatticeImage</a>(ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,Func);
<a name="l00687"></a>00687   <span class="keywordflow">if</span> (<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a>(LatIm)) {
<a name="l00688"></a>00688     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(LatIm);
<a name="l00689"></a>00689     <span class="keywordflow">return</span> NULL;
<a name="l00690"></a>00690   }
<a name="l00691"></a>00691   Pol = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(ZPol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00692"></a>00692   PolImage = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(Pol,Func,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00693"></a>00693   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Pol);
<a name="l00694"></a>00694   <span class="keywordflow">if</span>(<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(PolImage)) {
<a name="l00695"></a>00695     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (LatIm);
<a name="l00696"></a>00696     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (PolImage);
<a name="l00697"></a>00697     <span class="keywordflow">return</span> NULL;
<a name="l00698"></a>00698   } 
<a name="l00699"></a>00699   Pol = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(PolImage,LatIm,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00700"></a>00700   Result = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(LatIm,Pol);
<a name="l00701"></a>00701   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Pol);
<a name="l00702"></a>00702   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(PolImage);
<a name="l00703"></a>00703   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(LatIm);
<a name="l00704"></a>00704   <span class="keywordflow">return</span> Result;  
<a name="l00705"></a>00705 } <span class="comment">/* ZPolyhedronImage */</span> 
<a name="l00706"></a>00706 
<a name="l00707"></a>00707 <span class="comment">/*</span>
<a name="l00708"></a>00708 <span class="comment"> * Return the preimage of the Z-polyhedron &#39;Zpol&#39; under an affine transformati-</span>
<a name="l00709"></a>00709 <span class="comment"> * on function &#39;G&#39;. The number of rows of matrix representing the function &#39;G&#39;,</span>
<a name="l00710"></a>00710 <span class="comment"> * must be equal to the number of rows of the matrix representing the lattice </span>
<a name="l00711"></a>00711 <span class="comment"> * of Z1. </span>
<a name="l00712"></a>00712 <span class="comment"> * Algorithm: </span>
<a name="l00713"></a>00713 <span class="comment"> *            1) Let Zpol = L (intersect) Q</span>
<a name="l00714"></a>00714 <span class="comment"> *            2) L1 =LatticePreimage(L,F);</span>
<a name="l00715"></a>00715 <span class="comment"> *            3) Q1 = DomainPreimage(Q,F);</span>
<a name="l00716"></a>00716 <span class="comment"> *            4) Z1 = L1(Inverse(L1)*Q1);</span>
<a name="l00717"></a>00717 <span class="comment"> *            5) Return Z1</span>
<a name="l00718"></a>00718 <span class="comment"> */</span>
<a name="l00719"></a><a class="code" href="Zpolyhedron_8c.html#a16289c71b1e52682c9e2dd35d425bf82">00719</a> <span class="keyword">static</span> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a16289c71b1e52682c9e2dd35d425bf82">ZPolyhedronPreimage</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol, <a class="code" href="structmatrix.html">Matrix</a> *G) {
<a name="l00720"></a>00720   
<a name="l00721"></a>00721   <a class="code" href="structmatrix.html">Lattice</a> *Latpreim;
<a name="l00722"></a>00722   <a class="code" href="structpolyhedron.html">Polyhedron</a> *Qprime, *Q, *Polpreim;
<a name="l00723"></a>00723   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result;
<a name="l00724"></a>00724   
<a name="l00725"></a>00725 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00726"></a>00726 <span class="preprocessor"></span>  FILE *fp;
<a name="l00727"></a>00727   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>);
<a name="l00728"></a>00728   fprintf(fp,<span class="stringliteral">&quot;\nEntered ZPOLYHEDRONPREIMAGE\n&quot;</span>);
<a name="l00729"></a>00729   fclose(fp);
<a name="l00730"></a>00730 <span class="preprocessor">#endif</span>
<a name="l00731"></a>00731 <span class="preprocessor"></span>  
<a name="l00732"></a>00732   <span class="keywordflow">if</span>(G-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>) {
<a name="l00733"></a>00733     fprintf(stderr,<span class="stringliteral">&quot;\nIn ZPolyhedronPreimage: Error, The dimensions of the &quot;</span>);
<a name="l00734"></a>00734     fprintf(stderr,<span class="stringliteral">&quot;function are not compatible with that of the Zpolyhedron&quot;</span>);
<a name="l00735"></a>00735     <span class="keywordflow">return</span> <a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(G-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1);
<a name="l00736"></a>00736   }
<a name="l00737"></a>00737   Q = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00738"></a>00738   Polpreim = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(Q,G,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00739"></a>00739   <span class="keywordflow">if</span> (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(Polpreim))
<a name="l00740"></a>00740     Result = NULL;
<a name="l00741"></a>00741   <span class="keywordflow">else</span> {
<a name="l00742"></a>00742     Latpreim = <a class="code" href="Lattice_8c.html#a0c4b5df1248325964344c44d1b3b93ed">LatticePreimage</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,G);
<a name="l00743"></a>00743     <span class="keywordflow">if</span>(<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a>(Latpreim))
<a name="l00744"></a>00744       Result = NULL;
<a name="l00745"></a>00745     <span class="keywordflow">else</span> {
<a name="l00746"></a>00746       Qprime = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(Polpreim, Latpreim, <a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00747"></a>00747       Result = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(Latpreim, Qprime);
<a name="l00748"></a>00748       <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Qprime);
<a name="l00749"></a>00749     }
<a name="l00750"></a>00750     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(Latpreim);
<a name="l00751"></a>00751   }  
<a name="l00752"></a>00752   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Q);
<a name="l00753"></a>00753   <span class="keywordflow">return</span> Result; 
<a name="l00754"></a>00754 } <span class="comment">/* ZPolyhedronPreimage */</span> 
<a name="l00755"></a>00755 
<a name="l00756"></a>00756 <span class="comment">/* </span>
<a name="l00757"></a>00757 <span class="comment"> * Return the Z-polyhderon &#39;Zpol&#39; in canonical form: &#39;Result&#39; (for the Z-poly-</span>
<a name="l00758"></a>00758 <span class="comment"> * hedron in canonical form) and Basis &#39;Basis&#39; (for the basis with respect to </span>
<a name="l00759"></a>00759 <span class="comment"> * which &#39;Result&#39; is in canonical form.   </span>
<a name="l00760"></a>00760 <span class="comment"> */</span>
<a name="l00761"></a><a class="code" href="Zpolyhedron_8h.html#ae1596918aafc05f8d325722fbfa11d63">00761</a> <span class="keywordtype">void</span> <a class="code" href="Zpolyhedron_8c.html#ae1596918aafc05f8d325722fbfa11d63">CanonicalForm</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol,<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> **Result,<a class="code" href="structmatrix.html">Matrix</a> **Basis) {
<a name="l00762"></a>00762 
<a name="l00763"></a>00763   <a class="code" href="structmatrix.html">Matrix</a> *B1 = NULL, *B2=NULL, *T1 , *B2inv;
<a name="l00764"></a>00764   <span class="keywordtype">int</span> i, l1, l2;
<a name="l00765"></a>00765   Value tmp;
<a name="l00766"></a>00766   <a class="code" href="structpolyhedron.html">Polyhedron</a> *Image, *ImageP;
<a name="l00767"></a>00767   <a class="code" href="structmatrix.html">Matrix</a> *H, *U, *temp, *Hprime, *Uprime, *T2;
<a name="l00768"></a>00768   
<a name="l00769"></a>00769 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00770"></a>00770 <span class="preprocessor"></span>  FILE *fp;
<a name="l00771"></a>00771   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00772"></a>00772   fprintf(fp,<span class="stringliteral">&quot;\nEntered CANONICALFORM\n&quot;</span>);
<a name="l00773"></a>00773   fclose(fp);
<a name="l00774"></a>00774 <span class="preprocessor">#endif</span>
<a name="l00775"></a>00775 <span class="preprocessor"></span>  
<a name="l00776"></a>00776   <span class="keywordflow">if</span>(<a class="code" href="Zpolyhedron_8c.html#ab0afb5489d7025a2d231d1d769c74ffe">isEmptyZPolyhedron</a> (Zpol)) {
<a name="l00777"></a>00777     Basis[0] = <a class="code" href="Matop_8c.html#ac886b07103118bccddf1693e2bb9655f">Identity</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>);
<a name="l00778"></a>00778     Result[0] = <a class="code" href="Zpolyhedron_8c.html#adfc6db1caf4e0cbc2cbac31f2e076cfc">ZDomain_Copy</a> (Zpol);
<a name="l00779"></a>00779     return ;
<a name="l00780"></a>00780   }
<a name="l00781"></a>00781   <a class="code" href="arithmetique_8h.html#af71a2ca0294a19cff0cdcbdcc052ee27">value_init</a>(tmp);
<a name="l00782"></a>00782   l1 = <a class="code" href="Lattice_8c.html#aee5cf58a5c79a49ada7909b84440499a">FindHermiteBasisofDomain</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,&amp;B1);
<a name="l00783"></a>00783   Image = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a> (Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,(<a class="code" href="structmatrix.html">Matrix</a> *)Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00784"></a>00784   l2 = <a class="code" href="Lattice_8c.html#aee5cf58a5c79a49ada7909b84440499a">FindHermiteBasisofDomain</a>(Image,&amp;B2);
<a name="l00785"></a>00785     
<a name="l00786"></a>00786   <span class="keywordflow">if</span> (l1 != l2)
<a name="l00787"></a>00787     fprintf(stderr,<span class="stringliteral">&quot;In CNF : Something wrong with the Input Zpolyhedra \n&quot;</span>); 
<a name="l00788"></a>00788   
<a name="l00789"></a>00789   B2inv = <a class="code" href="matrix_8c.html#ac0b29e1d99a2823ad00b5f2157879d80">Matrix_Alloc</a>(B2-&gt;NbRows, B2-&gt;NbColumns);
<a name="l00790"></a>00790   temp = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(B2);
<a name="l00791"></a>00791   <a class="code" href="matrix_8c.html#a97aa755c011357ce2146d71ddb88ded6">Matrix_Inverse</a>(temp,B2inv);
<a name="l00792"></a>00792   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(temp);
<a name="l00793"></a>00793   
<a name="l00794"></a>00794   temp = <a class="code" href="matrix_8c.html#ac0b29e1d99a2823ad00b5f2157879d80">Matrix_Alloc</a>(B2inv-&gt;NbRows,Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>);
<a name="l00795"></a>00795   T1 = <a class="code" href="matrix_8c.html#ac0b29e1d99a2823ad00b5f2157879d80">Matrix_Alloc</a>(temp-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>,B1-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>);
<a name="l00796"></a>00796   <a class="code" href="matrix_8c.html#a1e967c74adaa2eec868fd737a55b6624">Matrix_Product</a>(B2inv,(<a class="code" href="structmatrix.html">Matrix</a> *)Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,temp);
<a name="l00797"></a>00797   <a class="code" href="matrix_8c.html#a1e967c74adaa2eec868fd737a55b6624">Matrix_Product</a>(temp,B1,T1);  
<a name="l00798"></a>00798   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(temp);
<a name="l00799"></a>00799   
<a name="l00800"></a>00800   T2 = <a class="code" href="Lattice_8c.html#a2e1e0a75d5fb3ddf7cac35b0c6ffc75b">ChangeLatticeDimension</a>(T1,l1);
<a name="l00801"></a>00801   temp = <a class="code" href="Lattice_8c.html#a2e1e0a75d5fb3ddf7cac35b0c6ffc75b">ChangeLatticeDimension</a>(T2,T2-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>+1);
<a name="l00802"></a>00802 
<a name="l00803"></a>00803   <span class="comment">/* Adding the affine part */</span>
<a name="l00804"></a>00804   <span class="keywordflow">for</span>(i = 0; i &lt; l1; i ++)
<a name="l00805"></a>00805     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(temp-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][temp-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1],T1-&gt;p[i][T1-&gt;NbColumns-1]);
<a name="l00806"></a>00806   
<a name="l00807"></a>00807   <a class="code" href="Lattice_8c.html#a4d75ea3bed92d944fc4be0ec7e08bd15">AffineHermite</a>(temp,&amp;H,&amp;U);
<a name="l00808"></a>00808   Hprime = <a class="code" href="Lattice_8c.html#a2e1e0a75d5fb3ddf7cac35b0c6ffc75b">ChangeLatticeDimension</a>(H,Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>);
<a name="l00809"></a>00809   
<a name="l00810"></a>00810   <span class="comment">/* Exchanging the Affine part */</span>
<a name="l00811"></a>00811   <span class="keywordflow">for</span>(i = 0; i &lt; l1; i ++) {
<a name="l00812"></a>00812     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(tmp,Hprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][Hprime-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1]);
<a name="l00813"></a>00813     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(Hprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][Hprime-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1],Hprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][H-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1]);
<a name="l00814"></a>00814     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(Hprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][H-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1],tmp);
<a name="l00815"></a>00815   }
<a name="l00816"></a>00816   Uprime = <a class="code" href="Lattice_8c.html#a2e1e0a75d5fb3ddf7cac35b0c6ffc75b">ChangeLatticeDimension</a>(U,Zpol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>);
<a name="l00817"></a>00817   
<a name="l00818"></a>00818   <span class="comment">/* Exchanging the Affine part */</span>
<a name="l00819"></a>00819   <span class="keywordflow">for</span> (i = 0;i &lt; l1; i++) {
<a name="l00820"></a>00820     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(tmp,Uprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][Uprime-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1]);
<a name="l00821"></a>00821     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(Uprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][Uprime-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1],Uprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][U-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1]);
<a name="l00822"></a>00822     <a class="code" href="arithmetique_8h.html#a864613888dc46f15679aa4f63e468f89">value_assign</a>(Uprime-&gt;<a class="code" href="structmatrix.html#a2c6d840d8d911ae95c2ae4fc96f4b5ba">p</a>[i][U-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>-1],tmp);
<a name="l00823"></a>00823   }    
<a name="l00824"></a>00824   <a class="code" href="polyhedron_8c.html#a4ae97b9794e3a616f1d38c68e6515cc3">Polyhedron_Free</a> (Image);
<a name="l00825"></a>00825   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (B2inv);
<a name="l00826"></a>00826   B2inv = <a class="code" href="matrix_8c.html#ac0b29e1d99a2823ad00b5f2157879d80">Matrix_Alloc</a>(B1-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>, B1-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>);
<a name="l00827"></a>00827   <a class="code" href="matrix_8c.html#a97aa755c011357ce2146d71ddb88ded6">Matrix_Inverse</a>(B1,B2inv);
<a name="l00828"></a>00828   ImageP = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(Zpol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>, B2inv, <a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00829"></a>00829   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(B2inv);
<a name="l00830"></a>00830   Image = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(ImageP, Uprime, <a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00831"></a>00831   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(ImageP);
<a name="l00832"></a>00832   Result[0] = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(Hprime, Image);
<a name="l00833"></a>00833   Basis[0] = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(B2); 
<a name="l00834"></a>00834   
<a name="l00835"></a>00835   <span class="comment">/* Free the variables */</span>
<a name="l00836"></a>00836   <a class="code" href="polyhedron_8c.html#a4ae97b9794e3a616f1d38c68e6515cc3">Polyhedron_Free</a> (Image);
<a name="l00837"></a>00837   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (B1);
<a name="l00838"></a>00838   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (B2);
<a name="l00839"></a>00839   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (temp);
<a name="l00840"></a>00840   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (T1);
<a name="l00841"></a>00841   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (T2);
<a name="l00842"></a>00842   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (H);
<a name="l00843"></a>00843   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (U);
<a name="l00844"></a>00844   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (Hprime);
<a name="l00845"></a>00845   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a> (Uprime);
<a name="l00846"></a>00846   <a class="code" href="arithmetique_8h.html#ab9b282921e85a0527d462d331533d619">value_clear</a>(tmp);
<a name="l00847"></a>00847   <span class="keywordflow">return</span>;
<a name="l00848"></a>00848 } <span class="comment">/* CanonicalForm */</span> 
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="comment">/*</span>
<a name="l00851"></a>00851 <span class="comment"> * Given a Z-polyhedron &#39;A&#39; in which the Lattice is not integral, return the</span>
<a name="l00852"></a>00852 <span class="comment"> * Z-polyhedron which contains all the integral points in the input lattice.</span>
<a name="l00853"></a>00853 <span class="comment"> */</span>
<a name="l00854"></a><a class="code" href="Zpolyhedron_8h.html#a18679eb2fc30e66ff57146b427f3d7a8">00854</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a18679eb2fc30e66ff57146b427f3d7a8">IntegraliseLattice</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *A) {
<a name="l00855"></a>00855  
<a name="l00856"></a>00856   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Result;
<a name="l00857"></a>00857   <a class="code" href="structmatrix.html">Lattice</a> *M = NULL, *Id;
<a name="l00858"></a>00858   <a class="code" href="structpolyhedron.html">Polyhedron</a> *Im = NULL, *Preim = NULL;
<a name="l00859"></a>00859 
<a name="l00860"></a>00860 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00861"></a>00861 <span class="preprocessor"></span>  FILE *fp;
<a name="l00862"></a>00862   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>);
<a name="l00863"></a>00863   fprintf(fp,<span class="stringliteral">&quot;\nEntered INTEGRALISELATTICE\n&quot;</span>);
<a name="l00864"></a>00864   fclose(fp);
<a name="l00865"></a>00865 <span class="preprocessor">#endif</span>
<a name="l00866"></a>00866 <span class="preprocessor"></span>  
<a name="l00867"></a>00867   Im = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(A-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00868"></a>00868   Id = <a class="code" href="Matop_8c.html#ac886b07103118bccddf1693e2bb9655f">Identity</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>);
<a name="l00869"></a>00869   M = <a class="code" href="Lattice_8c.html#ac67608cf4d08c51aa76da79051507fd4">LatticeImage</a>(Id, A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>);
<a name="l00870"></a>00870   <span class="keywordflow">if</span> (<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a>(M))
<a name="l00871"></a>00871     Result = <a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(A-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1);
<a name="l00872"></a>00872   <span class="keywordflow">else</span> {
<a name="l00873"></a>00873     Preim = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(Im,M,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00874"></a>00874     Result = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(M,Preim);
<a name="l00875"></a>00875   }  
<a name="l00876"></a>00876   <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(M);
<a name="l00877"></a>00877   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Im);
<a name="l00878"></a>00878   <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Preim);  
<a name="l00879"></a>00879   <span class="keywordflow">return</span> Result;
<a name="l00880"></a>00880 } <span class="comment">/* IntegraliseLattice */</span> 
<a name="l00881"></a>00881 
<a name="l00882"></a>00882 <span class="comment">/* </span>
<a name="l00883"></a>00883 <span class="comment"> * Return the simplified representation of the Z-domain &#39;ZDom&#39;. It attempts to </span>
<a name="l00884"></a>00884 <span class="comment"> * convexize unions of polyhedra when they correspond to the same lattices and</span>
<a name="l00885"></a>00885 <span class="comment"> * to simplify union of lattices when they correspond to the same polyhdera. </span>
<a name="l00886"></a>00886 <span class="comment"> */</span>
<a name="l00887"></a><a class="code" href="Zpolyhedron_8h.html#ae1ea837411351d529bbdeed37fe5c9c8">00887</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#ae1ea837411351d529bbdeed37fe5c9c8">ZDomainSimplify</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *ZDom) {
<a name="l00888"></a>00888   
<a name="l00889"></a>00889   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Ztmp, *Result;
<a name="l00890"></a>00890   <a class="code" href="structforsimplify.html">ForSimplify</a> *Head, *Prev, *Curr;
<a name="l00891"></a>00891   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *ZDomHead, *Emp;
<a name="l00892"></a>00892   
<a name="l00893"></a>00893   <span class="keywordflow">if</span> (ZDom == NULL) {
<a name="l00894"></a>00894     fprintf(stderr,<span class="stringliteral">&quot;\nError in ZDomainSimplify - ZDomHead = NULL\n&quot;</span>);
<a name="l00895"></a>00895     <span class="keywordflow">return</span> NULL;
<a name="l00896"></a>00896   }  
<a name="l00897"></a>00897   <span class="keywordflow">if</span> (ZDom-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> == NULL)
<a name="l00898"></a>00898     <span class="keywordflow">return</span> (<a class="code" href="Zpolyhedron_8c.html#a7356b208941d309c1178da1b9f24157c">ZPolyhedron_Copy</a> (ZDom));  
<a name="l00899"></a>00899   Emp = <a class="code" href="Zpolyhedron_8c.html#aa6461cb4a6bb43dd044c483570d632b5">EmptyZPolyhedron</a>(ZDom-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>-1);
<a name="l00900"></a>00900   ZDomHead = <a class="code" href="Zpolyhedron_8c.html#aeb4a3836b97a8283580c03d3cc71ed00">ZDomainUnion</a>(ZDom, Emp);
<a name="l00901"></a>00901   <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(Emp);  
<a name="l00902"></a>00902   Head = NULL;
<a name="l00903"></a>00903   Ztmp = ZDomHead;
<a name="l00904"></a>00904   <span class="keywordflow">do</span> {
<a name="l00905"></a>00905     <a class="code" href="structpolyhedron.html">Polyhedron</a> *Img;
<a name="l00906"></a>00906     Img = <a class="code" href="polyhedron_8c.html#a8b92d94a0a1cbd47b98e9f72f34c43eb">DomainImage</a>(Ztmp-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>,Ztmp-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00907"></a>00907     <span class="keywordflow">for</span>(Curr = Head; Curr != NULL; Curr = Curr-&gt;<a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">next</a>) {
<a name="l00908"></a>00908       <a class="code" href="structpolyhedron.html">Polyhedron</a> *Diff1;
<a name="l00909"></a>00909       <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309">Bool</a> flag = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;
<a name="l00910"></a>00910       
<a name="l00911"></a>00911       Diff1 = <a class="code" href="polyhedron_8c.html#aaaefa8685a2b2819b9863f2e4ff427f5">DomainDifference</a>(Img,Curr-&gt;<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00912"></a>00912       <span class="keywordflow">if</span> (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(Diff1)) {
<a name="l00913"></a>00913         <a class="code" href="structpolyhedron.html">Polyhedron</a> *Diff2;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915         Diff2 = <a class="code" href="polyhedron_8c.html#aaaefa8685a2b2819b9863f2e4ff427f5">DomainDifference</a>(Curr-&gt;<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a>,Img,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>); 
<a name="l00916"></a>00916         <span class="keywordflow">if</span> (<a class="code" href="types_8h.html#a156641ae25106f9a6ac5c5c2a624c168">emptyQ</a>(Diff2))
<a name="l00917"></a>00917           flag = <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;  
<a name="l00918"></a>00918         <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Diff2);
<a name="l00919"></a>00919       }      
<a name="l00920"></a>00920       <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (Diff1);
<a name="l00921"></a>00921       <span class="keywordflow">if</span> (flag == <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l00922"></a>00922         <a class="code" href="structLatticeUnion.html">LatticeUnion</a> *temp;     
<a name="l00923"></a>00923         
<a name="l00924"></a>00924         temp = (<a class="code" href="structLatticeUnion.html">LatticeUnion</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structLatticeUnion.html">LatticeUnion</a>));
<a name="l00925"></a>00925         temp-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a> = (<a class="code" href="structmatrix.html">Lattice</a> *)<a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>((<a class="code" href="structmatrix.html">Matrix</a> *)Ztmp-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>); 
<a name="l00926"></a>00926         temp-&gt;<a class="code" href="structLatticeUnion.html#ab21274825bf2e44967e1fcf6f42bcd88">next</a> = Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>;
<a name="l00927"></a>00927         Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a> = temp;
<a name="l00928"></a>00928         <span class="keywordflow">break</span>;
<a name="l00929"></a>00929       }
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931     <span class="keywordflow">if</span>(Curr == NULL) {
<a name="l00932"></a>00932       Curr = (<a class="code" href="structforsimplify.html">ForSimplify</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structforsimplify.html">ForSimplify</a>));      
<a name="l00933"></a>00933       Curr-&gt;<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a> = <a class="code" href="polyhedron_8c.html#ad57e191f32f3c9022ec00747f4908b3f">Domain_Copy</a>(Img);
<a name="l00934"></a>00934       Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a> = (<a class="code" href="structLatticeUnion.html">LatticeUnion</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structLatticeUnion.html">LatticeUnion</a>));
<a name="l00935"></a>00935       Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a> = (<a class="code" href="structmatrix.html">Lattice</a> *)<a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>((<a class="code" href="structmatrix.html">Matrix</a> *)Ztmp-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>); 
<a name="l00936"></a>00936       Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>-&gt;<a class="code" href="structLatticeUnion.html#ab21274825bf2e44967e1fcf6f42bcd88">next</a> = NULL;
<a name="l00937"></a>00937       Curr-&gt;<a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">next</a> = Head;
<a name="l00938"></a>00938       Head = Curr;
<a name="l00939"></a>00939     }   
<a name="l00940"></a>00940     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a> (Img);
<a name="l00941"></a>00941     Ztmp = Ztmp-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a>;
<a name="l00942"></a>00942   } <span class="keywordflow">while</span>(Ztmp != NULL);
<a name="l00943"></a>00943   
<a name="l00944"></a>00944   <span class="keywordflow">for</span> (Curr = Head; Curr != NULL; Curr = Curr-&gt;<a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">next</a>)
<a name="l00945"></a>00945     Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a> = <a class="code" href="Lattice_8c.html#abcae5a642b26c67f65db8de16cca6064">LatticeSimplify</a>(Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>);  
<a name="l00946"></a>00946   Result = NULL;
<a name="l00947"></a>00947   <span class="keywordflow">for</span>(Curr = Head; Curr != NULL; Curr = Curr-&gt;<a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">next</a>) {
<a name="l00948"></a>00948     <a class="code" href="structLatticeUnion.html">LatticeUnion</a> *L;    
<a name="l00949"></a>00949     <span class="keywordflow">for</span>(L = Curr-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>; L != NULL; L = L-&gt;<a class="code" href="structLatticeUnion.html#ab21274825bf2e44967e1fcf6f42bcd88">next</a>) {
<a name="l00950"></a>00950       <a class="code" href="structpolyhedron.html">Polyhedron</a> *Preim;
<a name="l00951"></a>00951       <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *Zpol;
<a name="l00952"></a>00952       
<a name="l00953"></a>00953       Preim = <a class="code" href="polyhedron_8c.html#a494ede0f23752164d1c839085a0e3be2">DomainPreimage</a>(Curr-&gt;<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a>,L-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a>,<a class="code" href="types_8h.html#a7a3726264ecf2f0985882e0c1adb4ddb">MAXNOOFRAYS</a>);
<a name="l00954"></a>00954       Zpol = <a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(L-&gt;<a class="code" href="structLatticeUnion.html#ab9b004530ace366d12a2cf46e7a13175">M</a>, Preim);
<a name="l00955"></a>00955       Zpol-&gt;<a class="code" href="structZPolyhedron.html#a03a31e09bc3818f7b069323376699bb2">next</a> = Result;
<a name="l00956"></a>00956       Result = Zpol;
<a name="l00957"></a>00957       <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Preim);
<a name="l00958"></a>00958     }
<a name="l00959"></a>00959   }  
<a name="l00960"></a>00960   Curr = Head;
<a name="l00961"></a>00961   <span class="keywordflow">while</span> (Curr != NULL) {
<a name="l00962"></a>00962     Prev = Curr;
<a name="l00963"></a>00963     Curr = Curr-&gt;<a class="code" href="structforsimplify.html#ad9915cf27ad8523c0fe4adc2cc60a8f3">next</a>;     
<a name="l00964"></a>00964     <a class="code" href="Lattice_8c.html#ad405c032776bc0e029b1d431b3cab314">LatticeUnion_Free</a>(Prev-&gt;<a class="code" href="structforsimplify.html#aa52bc2f65f7c2e3b5bc637fb820c03bb">LatUni</a>);
<a name="l00965"></a>00965     <a class="code" href="polyhedron_8c.html#ae6d0a7daf8e801a777fc8e93d8cfe43a">Domain_Free</a>(Prev-&gt;<a class="code" href="structforsimplify.html#a9cdbe08c366739453ec91de5081e3a2d">Pol</a>);
<a name="l00966"></a>00966     free(Prev);
<a name="l00967"></a>00967   }
<a name="l00968"></a>00968   <span class="keywordflow">return</span> Result;
<a name="l00969"></a>00969 } <span class="comment">/* ZDomainSimplify */</span> 
<a name="l00970"></a>00970 
<a name="l00971"></a><a class="code" href="Zpolyhedron_8h.html#a78437f3fbab465d27271ef2928328995">00971</a> <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *<a class="code" href="Zpolyhedron_8c.html#a78437f3fbab465d27271ef2928328995">SplitZpolyhedron</a>(<a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *ZPol,<a class="code" href="structmatrix.html">Lattice</a> *B) {
<a name="l00972"></a>00972  
<a name="l00973"></a>00973   <a class="code" href="structmatrix.html">Lattice</a> *Intersection = NULL;
<a name="l00974"></a>00974   <a class="code" href="structmatrix.html">Lattice</a> *B1 = NULL, *B2 = NULL, *newB1 = NULL, *newB2 = NULL;
<a name="l00975"></a>00975   <a class="code" href="structmatrix.html">Matrix</a> *U = NULL,*M1 = NULL, *M2 = NULL, *M1Inverse = NULL,*MtProduct = NULL;
<a name="l00976"></a>00976   <a class="code" href="structmatrix.html">Matrix</a> *Vinv, *V , *temp, *DiagMatrix ;
<a name="l00977"></a>00977   <a class="code" href="structmatrix.html">Matrix</a> *H , *U1 , *X, *Y ;
<a name="l00978"></a>00978   <a class="code" href="structZPolyhedron.html">ZPolyhedron</a> *zpnew, *Result;
<a name="l00979"></a>00979   <a class="code" href="structLatticeUnion.html">LatticeUnion</a> *Head = NULL, *tempHead = NULL;
<a name="l00980"></a>00980   <span class="keywordtype">int</span> i;
<a name="l00981"></a>00981   Value k;
<a name="l00982"></a>00982   
<a name="l00983"></a>00983 <span class="preprocessor">#ifdef DOMDEBUG</span>
<a name="l00984"></a>00984 <span class="preprocessor"></span>  FILE *fp;
<a name="l00985"></a>00985   fp = fopen(<span class="stringliteral">&quot;_debug&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00986"></a>00986   fprintf(fp,<span class="stringliteral">&quot;\nEntered SplitZpolyhedron \n&quot;</span>); 
<a name="l00987"></a>00987   fclose(fp);
<a name="l00988"></a>00988 <span class="preprocessor">#endif</span>
<a name="l00989"></a>00989 <span class="preprocessor"></span>
<a name="l00990"></a>00990   
<a name="l00991"></a>00991   <span class="keywordflow">if</span> (B-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != B-&gt;<a class="code" href="structmatrix.html#a68858fd3b57684ef38bdfce13c65d182">NbColumns</a>) { 
<a name="l00992"></a>00992     fprintf(stderr,<span class="stringliteral">&quot;\n SplitZpolyhedron : The Input Matrix B is not a proper Lattice \n&quot;</span>);
<a name="l00993"></a>00993     <span class="keywordflow">return</span> NULL;
<a name="l00994"></a>00994   }
<a name="l00995"></a>00995   
<a name="l00996"></a>00996   <span class="keywordflow">if</span> (ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a> != B-&gt;<a class="code" href="structmatrix.html#a16ad614d15c6e81c0041e877b623c72d">NbRows</a>) {
<a name="l00997"></a>00997     fprintf(stderr,<span class="stringliteral">&quot;\nSplitZpolyhedron : The Lattice in Zpolyhedron and B have &quot;</span>);
<a name="l00998"></a>00998     fprintf(stderr,<span class="stringliteral">&quot;incompatible dimensions \n&quot;</span>);
<a name="l00999"></a>00999     <span class="keywordflow">return</span> NULL;
<a name="l01000"></a>01000   }
<a name="l01001"></a>01001   
<a name="l01002"></a>01002   <span class="keywordflow">if</span> (<a class="code" href="Matop_8c.html#a3f47c6fa59a6178c86d3990bb25af47b">isinHnf</a> (ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>) != <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l01003"></a>01003     <a class="code" href="Lattice_8c.html#a4d75ea3bed92d944fc4be0ec7e08bd15">AffineHermite</a>(ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>,&amp;H,&amp;U1);
<a name="l01004"></a>01004     X = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(H);    
<a name="l01005"></a>01005     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(U1);
<a name="l01006"></a>01006     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(H);
<a name="l01007"></a>01007   }
<a name="l01008"></a>01008   <span class="keywordflow">else</span>
<a name="l01009"></a>01009     X = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(ZPol-&gt;<a class="code" href="structZPolyhedron.html#a99898c1e05ac9dd7043b4bb900740b02">Lat</a>);
<a name="l01010"></a>01010   
<a name="l01011"></a>01011   <span class="keywordflow">if</span> (<a class="code" href="Matop_8c.html#a3f47c6fa59a6178c86d3990bb25af47b">isinHnf</a>(B) != <a class="code" href="types_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>) {
<a name="l01012"></a>01012     <a class="code" href="Lattice_8c.html#a4d75ea3bed92d944fc4be0ec7e08bd15">AffineHermite</a>(B,&amp;H,&amp;U1);
<a name="l01013"></a>01013     Y = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(H);   
<a name="l01014"></a>01014     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(H);
<a name="l01015"></a>01015     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(U1);
<a name="l01016"></a>01016   }
<a name="l01017"></a>01017   <span class="keywordflow">else</span>
<a name="l01018"></a>01018     Y = <a class="code" href="Matop_8c.html#a9d027e9fc6b85e6fa37fc284bf1b5e06">Matrix_Copy</a>(B);  
<a name="l01019"></a>01019   <span class="keywordflow">if</span> (<a class="code" href="Lattice_8c.html#a7a9a551062ace0251e9bb0ea6b74c860">isEmptyLattice</a>(X)) {
<a name="l01020"></a>01020     <span class="keywordflow">return</span> NULL;  
<a name="l01021"></a>01021   }
<a name="l01022"></a>01022 
<a name="l01023"></a>01023   Head=<a class="code" href="Lattice_8c.html#a020989e31cbf7e9cf32b85c4078fcb65">Lattice2LatticeUnion</a>(X,Y);
<a name="l01024"></a>01024 
<a name="l01025"></a>01025 <span class="comment">/* If the spliting operation can&#39;t be done the result is the original Zplyhedron. */</span>
<a name="l01026"></a>01026 
<a name="l01027"></a>01027   <span class="keywordflow">if</span> (Head == NULL) {
<a name="l01028"></a>01028     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(X);
<a name="l01029"></a>01029     <a class="code" href="matrix_8c.html#afcb312b7c12a6997cd66964ecc34e1a6">Matrix_Free</a>(Y);
<a name="l01030"></a>01030     <span class="keywordflow">return</span> ZPol;
<a name="l01031"></a>01031   }  
<a name="l01032"></a>01032 
<a name="l01033"></a>01033 
<a name="l01034"></a>01034   Result=NULL;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036   <span class="keywordflow">if</span> (Head)
<a name="l01037"></a>01037    <span class="keywordflow">while</span>(Head)
<a name="l01038"></a>01038     {
<a name="l01039"></a>01039       tempHead = Head;
<a name="l01040"></a>01040       Head = Head-&gt;<a class="code" href="structLatticeUnion.html#ab21274825bf2e44967e1fcf6f42bcd88">next</a>;  
<a name="l01041"></a>01041       zpnew=<a class="code" href="Zpolyhedron_8c.html#aea228bbc24564d06a571d0cae4303faa">ZPolyhedron_Alloc</a>(tempHead-&gt;M,ZPol-&gt;<a class="code" href="structZPolyhedron.html#aa02d9c99e02cb5f77550a865943637af">P</a>);
<a name="l01042"></a>01042       Result=<a class="code" href="Zpolyhedron_8c.html#a12543a0ea685af90e05e6ed5d1f45564">AddZPoly2ZDomain</a>(zpnew,Result);
<a name="l01043"></a>01043       <a class="code" href="Zpolyhedron_8c.html#a09673c936811862a3098cebc231a84ef">ZPolyhedron_Free</a>(zpnew);
<a name="l01044"></a>01044       tempHead-&gt;next = NULL; 
<a name="l01045"></a>01045       free(tempHead);  
<a name="l01046"></a>01046     }
<a name="l01047"></a>01047 
<a name="l01048"></a>01048   <span class="keywordflow">return</span> Result;
<a name="l01049"></a>01049 }
<a name="l01050"></a>01050 
<a name="l01051"></a>01051 
<a name="l01052"></a>01052 
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="Zpolyhedron_8c.html">Zpolyhedron.c</a>      </li>
      <li class="footer">Generated on Sun Dec 18 2011 13:22:49 for polylib by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
